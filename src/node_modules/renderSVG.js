const getOptionsFromCode = require('./getOptionsFromCode');

module.exports = async ({ page, encodedCode, bgColor }) => {
  const { code, mermaid: config } = getOptionsFromCode(encodedCode);
  await page.evaluate((def, cfg) => render(def, cfg), code, config);
  if (bgColor) {
    await page.$eval(
      '#container > svg',
      (e, bg) => (e.style.backgroundColor = bg),
      bgColor
    );
  }

  return;
};
